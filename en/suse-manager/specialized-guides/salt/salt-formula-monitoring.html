<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
<title>Monitoring Formula
     | SUSE Manager 4.3 Documentation</title>    <link rel="canonical" href="https://documentation.suse.com/suma/4.3/en/suse-manager/specialized-guides/salt/salt-formula-monitoring.html">
    <link rel="prev" href="salt-formula-imagesync.html">
    <link rel="next" href="salt-formula-pxe.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../_/css/site-extra.css">
<!-- <link rel="preconnect" href="https://fonts.gstatic.com"> -->
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js"
        type="text/javascript"></script>
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
   <div class="navbar-brand">
            <div class="navbar-item">
                <a class=" navbar-logo" href="https://documentation.suse.com/suma/"><img
                        class="logo" src="../../../_/img/logo.svg"/></a>
            </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
     <div id="topbar-nav" class="navbar-menu">
          <div class="navbar-end">
              <div class="navbar-item has-dropdown is-hoverable">
                  <div class="navbar-link"><img src="../../../_/img/resources.png" class="langIcon Resurces" alt="Resources" title="Resources"></div>
                  <div class="navbar-dropdown">
                      <!--  <div class="navbar-item"><strong>Resources</strong></div> -->
                      <a class="navbar-item" href="https://github.com/uyuni-project/uyuni-docs"><i
                              class="fab fa-github"></i>&nbsp;uyuni-docs</a>
                      <a class="navbar-item" href="https://github.com/uyuni-project/uyuni-docs/issues"><i
                              class="fab fa-github"></i>&nbsp;Report Issue</a>
                      <a class="navbar-item"
                         href="https://github.com/uyuni-project/uyuni-docs/wiki"><i
                              class="fas fa-user-edit"></i>&nbsp;Contribute</a>
                  </div>
              </div>
                           <div class="navbar-item has-dropdown is-hoverable">
                 <div class="navbar-link"><img src="../../../_/img/language.png" class="langIcon Language" alt="Language" title="Language"></div>
                 <div class="navbar-dropdown">
                     <!--  </div><div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->
                     <a role="button" class="navbar-item" id="en" onclick="selectLanguage(this.id)"><img src="../../../_/img/engFlag.svg" class="langIcon english">&nbsp;English</a>
                     <!-- LANGUAGESELECTOR -->
                     <a role="button" class="navbar-item" id="ko" onclick="selectLanguage(this.id)"><img src="../../../_/img/koFlag.svg" class="langIcon korea">&nbsp;한국어</a>
                     <a role="button" class="navbar-item" id="ja" onclick="selectLanguage(this.id)"><img src="../../../_/img/jaFlag.svg" class="langIcon japan">&nbsp;日本語</a>
                     <a role="button" class="navbar-item" id="zh_CN" onclick="selectLanguage(this.id)"><img src="../../../_/img/china.svg" class="langIcon china">&nbsp;中文</a>
                 </div>
             </div>
                
          </div>
      </div>
      <a id="twitter-link" class="navbar-item" href="https://twitter.com/susemanager">
          <span class="icon">
            <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 512 512">
              <path fill="#57aaee"
                    d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
            </svg>
          </span>
      </a>
   <!--   <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div> -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="suse-manager" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">SUSE Manager 4.3 Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../common_gfdl1.2_i.html">License</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides-overview.html">Specialized Guides</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../public-cloud-guide/overview.html">Public Cloud Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Generic Public Cloud</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../public-cloud-guide/setup.html">Initial Setup</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../public-cloud-guide/clients.html">Client Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PAYG Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-overview.html">Pay-as-you-go Overview</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-benefits.html">Benefits of PAYG</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PAYG on AWS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-faq.html">PAYG FAQ on AWS</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-country-listing.html">Supported Country List</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-aws-requirements.html">SUSE Manager AWS requirements</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-find-the-aws-image.html">Find the Image</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-configure-the-image.html">Configure the Image on EC2</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-start-the-image.html">Start the Instance</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-initial-setup.html">Initial Setup</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-start-the-server.html">Start the Server</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-webui-configuration.html">WebUI Configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="salt-overview.html">Salt Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-terminology.html">Terminology</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-command.html">Salt Command</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-useful-commands.html">Common Salt Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-states-and-pillars.html">Salt States and Pillars</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-gpg-encrypted-pillars.html">GPG Encrypted Pillars</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-custom-states.html">Custom Salt States</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-file-locations.html">File Locations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-gitfs.html">GitFS Fileserver Backend</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-yomi.html">Install Using Yomi</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-config-modules.html">Configuration Modules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="salt-formulas-intro.html">Salt Formulas</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formulas-by-product.html">Formulas provided by SUSE Manager</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-bind.html">Bind Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-branchnetwork.html">Branch Network Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-dhcpd.html">DHCPd Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-imagesync.html">Image Sync Formula</a>
  </li>
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="salt-formula-monitoring.html">Monitoring Formulas</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-pxe.html">PXE Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-saltboot.html">Saltboot Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-tftpd.html">TFTPd Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-vsftpd.html">VsFTPd Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-yomi.html">Yomi Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formulas-custom.html">Custom Salt Formulas</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-ssh.html">Salt SSH</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-rate-limiting.html">Rate Limiting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-scaling-minions.html">Scaling Minions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../large-deployments/overview.html">Large Deployments Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../large-deployments/hardware-reqs.html">Hardware Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../large-deployments/single-server.html">Single Server</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/operation-reqs.html">Operation Requirements</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../large-deployments/multi-server.html">Multiple Servers with Hub</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-reqs.html">Hub Operation Requirements</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-install.html">Hub Installation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-api.html">Hub API</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-namespaces.html">Hub Namespaces</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-auth.html">Hub Authentication</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-reporting.html">Hub Reporting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../large-deployments/retail-large-scale.html">Large Retail Environments</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../large-deployments/tuning.html">Tuning Large Installations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text">xref:large-deployments/monitoring.adoc[Monitoring Large Scale Deployments</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../qs-sap/overview.html">Quick Start: SAP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../qs-sap/prepare-server.html">Prepare Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../qs-sap/prepare-clients.html">Prepare Clients</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../qs-sap/configure.html">Configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE Manager 4.3 Documentation</span>
    <span class="version">default</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">SUSE Manager 4.3 Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">SUSE Manager 4.3 Documentation</a></li>
    <li><a href="../specialized-guides-overview.html">Specialized Guides</a></li>
    <li><a href="salt-overview.html">Salt Guide</a></li>
    <li><a href="salt-formulas-intro.html">Salt Formulas</a></li>
    <li><a href="salt-formula-monitoring.html">Monitoring Formulas</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Monitoring Formula</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_grafana">1. Grafana</a></li>
<li><a href="#_prometheus">2. Prometheus</a></li>
<li><a href="#_prometheus_exporters">3. Prometheus Exporters</a>
<ul class="sectlevel2">
<li><a href="#_file_based_service_discovery">3.1. File-based service discovery</a></li>
<li><a href="#_tls_certificates_and_keys">3.2. TLS certificates and keys</a></li>
</ul>
</li>
<li><a href="#_activate_forms">4. Activate Forms</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The monitoring services in SUSE Manager are configured using formulas with forms.
The package is installed by default, and contains these formulas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Grafana</p>
</li>
<li>
<p>Prometheus</p>
</li>
<li>
<p>Prometheus Exporters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about using monitoring, see <a href="../../administration/monitoring.html" class="xref page">Monitoring with Prometheus and Grafana</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_grafana"><a class="anchor" href="#_grafana"></a><a class="link" href="#_grafana">1. Grafana</a></h2>
<div class="sectionbody">
<div class="olist arabic">
<div class="title">Procedure: Configuring the Grafana Formula</div>
<ol class="arabic">
<li>
<p>Navigate to the <span class="menuseq"><b class="menu">Formulas</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Grafana</b></span> tab, and set these parameters in the <code class="guimenu">Grafana</code> section:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enabled</code> box to enable Grafana visualizations.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code class="guimenu">Initial admin password</code> is used on the first run only, and Grafana UI prompts to change it.
This field cannot be used to change the Grafana password.
For more information on how to change the password, see
<a href="../../administration/monitoring.html" class="xref page">Monitoring with Prometheus and Grafana</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>For each Prometheus data source you want to use, in the <span class="menuseq"><b class="menu">Datasources</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Prometheus</b></span> section, click <b class="button">+</b>, and set these parameters:</p>
<div class="ulist">
<ul>
<li>
<p>In the <code class="guimenu">Datasource name</code> field, type a name to identify the data source.</p>
</li>
<li>
<p>In the <code class="guimenu">Prometheus URL</code> field, type the used protocol, the location of the Prometheus server, and append port <code>9090</code>.
For example, <code><a href="http://example.com:9090" class="bare">http://example.com:9090</a></code>. In case TLS encryption is enabled in Prometheus formula make sure to use <code>https</code> protocol and FQDN.</p>
</li>
<li>
<p>In the fields <code class="guimenu">Prometheus server username</code> and <code class="guimenu">Prometheus server password</code>,
enter basic authentication credentials for Prometheus server matching the ones in Prometheus formula.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <code class="guimenu">Dashboards</code> section, check the dashboards you want to use:</p>
<div class="ulist">
<ul>
<li>
<p><code class="guimenu">Uyuni server dashboard</code></p>
</li>
<li>
<p><code class="guimenu">Uyuni clients dashboard</code></p>
</li>
<li>
<p><code class="guimenu">PostgreSQL dashboard</code></p>
</li>
<li>
<p><code class="guimenu">Apache HTTPD dashboard</code></p>
</li>
<li>
<p><code class="guimenu">Kubernetes cluster dashboard</code></p>
</li>
<li>
<p><code class="guimenu">Kubernetes etcd dashboard</code></p>
</li>
<li>
<p><code class="guimenu">Kubernetes namespaces dashboard</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <b class="button">Save Formula</b> to save your configuration.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prometheus"><a class="anchor" href="#_prometheus"></a><a class="link" href="#_prometheus">2. Prometheus</a></h2>
<div class="sectionbody">
<div class="olist arabic">
<div class="title">Procedure: Configuring the Prometheus Formula</div>
<ol class="arabic">
<li>
<p>Navigate to the <span class="menuseq"><b class="menu">Formulas</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Prometheus</b></span> tab, and set these parameters in the <code class="guimenu">Prometheus</code> section:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enabled</code> box to enable Prometheus monitoring.</p>
</li>
<li>
<p>In the <code class="guimenu">Scrape interval</code> field, type the frequency of data scraping, in seconds.
For example, <code>15</code> will scrape data every fifteen seconds.</p>
</li>
<li>
<p>In the <code class="guimenu">Evaluation interval</code> field, type the frequency of rules evaluation, in seconds.
For example, <code>15</code> will evaluate alerting and aggregation rules every fifteen seconds.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <code class="guimenu">TLS</code> section, set these parameters:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enabled</code> box to enable the secure configuration on Prometheus server.</p>
</li>
<li>
<p>In the <code class="guimenu">Server Certificate</code> field, type the path to the TLS server certificate.</p>
</li>
<li>
<p>In the <code class="guimenu">Server Key</code> field, type the path to the TLS server key.</p>
</li>
<li>
<p>In the <code class="guimenu">User</code> field, type the user name for Prometheus server.</p>
</li>
<li>
<p>In the <code class="guimenu">Password Hash</code> field, type the password for Prometheus server hashed with bcrypt.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <code class="guimenu">Uyuni Server</code> section, set these parameters:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enabled</code> box to enable monitoring on this server.</p>
</li>
<li>
<p>Check the <code class="guimenu">Autodiscover clients</code> box to enable Prometheus to automatically find and monitor new clients when they are added to the server.</p>
</li>
<li>
<p>In the <code class="guimenu">Username</code> field, type the user name of the Prometheus account on the server.</p>
</li>
<li>
<p>In the <code class="guimenu">Password</code> field, type the password of the Prometheus account on the server.</p>
</li>
<li>
<p>In the <code class="guimenu">Targets TLS</code> section, set these parameters:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enabled</code> box to enable the secure configuration for auto-discovered targets.</p>
</li>
<li>
<p>In the <code class="guimenu">CA Certificate</code> field, type the path to the Certificate Authority certificate.</p>
</li>
<li>
<p>In the <code class="guimenu">Client Certificate</code> field, type the path to the TLS client certificate for authentication.</p>
</li>
<li>
<p>In the <code class="guimenu">Client Key</code> field, type the path to the TLS client key for authentication.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>In the <code class="guimenu">Alerting</code> section, set these parameters:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enable local Alertmanager service</code> box to enable the alert manager service.</p>
</li>
<li>
<p>Check the <code class="guimenu">Use local Alertmanager</code> box to use the local alert manager service.</p>
</li>
</ul>
</div>
</li>
<li>
<p>For each alert manager you want to use, in the <span class="menuseq"><b class="menu">Alerting</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Alertmanagers</b></span> section, click <b class="button">+</b>, and set these parameters:</p>
<div class="ulist">
<ul>
<li>
<p>In the <code class="guimenu">IP Address:Port</code> field, type the location of the alert manager target, including the port number.</p>
</li>
</ul>
</div>
</li>
<li>
<p>To use a rule file, in the <span class="menuseq"><b class="menu">Alerting</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Rule Files</b></span> section, click <b class="button">+</b>, and set these parameters:</p>
<div class="ulist">
<ul>
<li>
<p>In the <code class="guimenu">Rule Files</code> field, type the location of the rule file you want to use.</p>
</li>
</ul>
</div>
</li>
<li>
<p>To add a custom scrape configuration, in the <code class="guimenu">User defined scrape configurations</code> section, click <b class="button">+</b>, and set these parameters:</p>
<div class="ulist">
<ul>
<li>
<p>In the <code class="guimenu">Job name</code> field, type a unique job name for your configuration.</p>
</li>
<li>
<p>In the <code class="guimenu">Files</code> field, type the location pattern of file service discovery files you want to use.
For more information, see the upstream documentation <a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#file_sd_config" class="bare">https://prometheus.io/docs/prometheus/latest/configuration/configuration/#file_sd_config</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <b class="button">Save Formula</b> to save your configuration.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The formula does not generate and deploy the TLS certificates and keys.
Ensure the files are present on the Salt client and readable for the user <code>prometheus</code> before applying the highstate.
For more information about generating client and server certificates, see <a href="../../administration/monitoring.html" class="xref page">Monitoring with Prometheus and Grafana</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prometheus_exporters"><a class="anchor" href="#_prometheus_exporters"></a><a class="link" href="#_prometheus_exporters">3. Prometheus Exporters</a></h2>
<div class="sectionbody">
<div class="olist arabic">
<div class="title">Procedure: Configuring the Prometheus Exporters Formula</div>
<ol class="arabic">
<li>
<p>Navigate to the <span class="menuseq"><b class="menu">Formulas</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Prometheus Exporters</b></span> tab, and set these parameters in the <code class="guimenu">Node Exporter</code> section:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enabled</code> box to enable the node exporter.</p>
</li>
<li>
<p>In the <code class="guimenu">Arguments</code> field, type any customized arguments for this exporter.
For example, <code>--web.listen-address=":9100"</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <code class="guimenu">Apache Exporter</code> section:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enabled</code> box to enable the Apache exporter.</p>
</li>
<li>
<p>In the <code class="guimenu">Arguments</code> field, type any customized arguments for this exporter.
For example, <code>--telemetry.address=":9117"</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <code class="guimenu">Postgres Exporter</code> section:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enabled</code> box to enable the PostreSQL exporter.</p>
</li>
<li>
<p>In the <code class="guimenu">Data source Name</code> field, type the name of the data source to use.</p>
</li>
<li>
<p>In the <code class="guimenu">Arguments</code> field, type any customized arguments for this exporter.
For example, <code>--web.listen-address=":9187"</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the <code class="guimenu">TLS</code> section:</p>
<div class="ulist">
<ul>
<li>
<p>Check the <code class="guimenu">Enabled</code> box to enable the secure configuration.</p>
</li>
<li>
<p>In the <code class="guimenu">CA Certificate</code> field, type the path to the Certificate Authority certificate.</p>
</li>
<li>
<p>In the <code class="guimenu">Server Certificate</code> field, type the path to the TLS server certificate.</p>
</li>
<li>
<p>In the <code class="guimenu">Server Key</code> field, type the path to the TLS server key.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <b class="button">Save Formula</b> to save your configuration.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_file_based_service_discovery"><a class="anchor" href="#_file_based_service_discovery"></a><a class="link" href="#_file_based_service_discovery">3.1. File-based service discovery</a></h3>
<div class="paragraph">
<p>It is possible to define monitored targets using file-based service discovery provided in the Prometheus formula.
This is a basic example demonstrating the usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[
  {
    "targets": [ "&lt;client1&gt;:9100", "&lt;client2&gt;:9100" ],
    "labels": {
      "role": "&lt;suma-client&gt;",
      "job": "&lt;suma-refclient&gt;"
    }
  },
  {
    "targets": [ "&lt;server&gt;:80" ],
    "labels": {
      "role": "&lt;suma-server&gt;",
      "job": "&lt;suma-refhost&gt;",
      "__metrics_path__": "/rhn/metrics"
    }
  }
]</pre>
</div>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://prometheus.io/docs/guides/file-sd/" class="bare">https://prometheus.io/docs/guides/file-sd/</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tls_certificates_and_keys"><a class="anchor" href="#_tls_certificates_and_keys"></a><a class="link" href="#_tls_certificates_and_keys">3.2. TLS certificates and keys</a></h3>
<div class="paragraph">
<p>The formula does not generate and deploy the TLS certificates and keys.
Ensure the files are present on the Salt client and readable for the user <code>prometheus</code> before applying the highstate.
For more information about generating client and server certificates, see <a href="../../administration/monitoring.html" class="xref page">Monitoring with Prometheus and Grafana</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_activate_forms"><a class="anchor" href="#_activate_forms"></a><a class="link" href="#_activate_forms">4. Activate Forms</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you have completed and saved all the forms, apply the highstate.</p>
</div>
<div class="paragraph">
<p>For more information about using monitoring, see <a href="../../administration/monitoring.html" class="xref page">Monitoring with Prometheus and Grafana</a>.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="salt-formula-imagesync.html">Image Sync Formula</a></span>
  <span class="next"><a href="salt-formula-pxe.html">PXE Formula</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
<script src="../../../_/js/vendor/langSelection.js"></script>

  </body>
</html>
