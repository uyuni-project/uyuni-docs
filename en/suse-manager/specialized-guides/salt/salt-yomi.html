<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
<title>Install Using Yomi
     | SUSE Manager 4.3 Documentation</title>    <link rel="canonical" href="https://documentation.suse.com/suma/4.3/en/suse-manager/specialized-guides/salt/salt-yomi.html">
    <link rel="prev" href="salt-gitfs.html">
    <link rel="next" href="salt-config-modules.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../_/css/site-extra.css">
<!-- <link rel="preconnect" href="https://fonts.gstatic.com"> -->
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js"
        type="text/javascript"></script>
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
   <div class="navbar-brand">
            <div class="navbar-item">
                <a class=" navbar-logo" href="https://documentation.suse.com/suma/"><img
                        class="logo" src="../../../_/img/logo.svg"/></a>
            </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
     <div id="topbar-nav" class="navbar-menu">
          <div class="navbar-end">
              <div class="navbar-item has-dropdown is-hoverable">
                  <div class="navbar-link"><img src="../../../_/img/resources.png" class="langIcon Resurces" alt="Resources" title="Resources"></div>
                  <div class="navbar-dropdown">
                      <!--  <div class="navbar-item"><strong>Resources</strong></div> -->
                      <a class="navbar-item" href="https://github.com/uyuni-project/uyuni-docs"><i
                              class="fab fa-github"></i>&nbsp;uyuni-docs</a>
                      <a class="navbar-item" href="https://github.com/uyuni-project/uyuni-docs/issues"><i
                              class="fab fa-github"></i>&nbsp;Report Issue</a>
                      <a class="navbar-item"
                         href="https://github.com/uyuni-project/uyuni-docs/wiki"><i
                              class="fas fa-user-edit"></i>&nbsp;Contribute</a>
                  </div>
              </div>
                           <div class="navbar-item has-dropdown is-hoverable">
                 <div class="navbar-link"><img src="../../../_/img/language.png" class="langIcon Language" alt="Language" title="Language"></div>
                 <div class="navbar-dropdown">
                     <!--  </div><div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->
                     <a role="button" class="navbar-item" id="en" onclick="selectLanguage(this.id)"><img src="../../../_/img/engFlag.svg" class="langIcon english">&nbsp;English</a>
                     <!-- LANGUAGESELECTOR -->
                     <a role="button" class="navbar-item" id="ko" onclick="selectLanguage(this.id)"><img src="../../../_/img/koFlag.svg" class="langIcon korea">&nbsp;한국어</a>
                     <a role="button" class="navbar-item" id="ja" onclick="selectLanguage(this.id)"><img src="../../../_/img/jaFlag.svg" class="langIcon japan">&nbsp;日本語</a>
                     <a role="button" class="navbar-item" id="zh_CN" onclick="selectLanguage(this.id)"><img src="../../../_/img/china.svg" class="langIcon china">&nbsp;中文</a>
                 </div>
             </div>
                
          </div>
      </div>
      <a id="twitter-link" class="navbar-item" href="https://twitter.com/susemanager">
          <span class="icon">
            <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 512 512">
              <path fill="#57aaee"
                    d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
            </svg>
          </span>
      </a>
   <!--   <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div> -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="suse-manager" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">SUSE Manager 4.3 Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../common_gfdl1.2_i.html">License</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides-overview.html">Specialized Guides</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../public-cloud-guide/overview.html">Public Cloud Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Generic Public Cloud</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../public-cloud-guide/setup.html">Initial Setup</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../public-cloud-guide/clients.html">Client Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PAYG Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-overview.html">Pay-as-you-go Overview</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-benefits.html">Benefits of PAYG</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PAYG on AWS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-faq.html">PAYG FAQ on AWS</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-country-listing.html">Supported Country List</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-aws-requirements.html">SUSE Manager AWS requirements</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-find-the-aws-image.html">Find the Image</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-configure-the-image.html">Configure the Image on EC2</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-start-the-image.html">Start the Instance</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-initial-setup.html">Initial Setup</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-start-the-server.html">Start the Server</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../public-cloud-guide/payg/payg-webui-configuration.html">WebUI Configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="salt-overview.html">Salt Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-terminology.html">Terminology</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-command.html">Salt Command</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-useful-commands.html">Common Salt Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-states-and-pillars.html">Salt States and Pillars</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-gpg-encrypted-pillars.html">GPG Encrypted Pillars</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-custom-states.html">Custom Salt States</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-file-locations.html">File Locations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-gitfs.html">GitFS Fileserver Backend</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="salt-yomi.html">Install Using Yomi</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-config-modules.html">Configuration Modules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="salt-formulas-intro.html">Salt Formulas</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formulas-by-product.html">Formulas provided by SUSE Manager</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-bind.html">Bind Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-branchnetwork.html">Branch Network Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-dhcpd.html">DHCPd Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-imagesync.html">Image Sync Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-monitoring.html">Monitoring Formulas</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-pxe.html">PXE Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-saltboot.html">Saltboot Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-tftpd.html">TFTPd Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-vsftpd.html">VsFTPd Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formula-yomi.html">Yomi Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="salt-formulas-custom.html">Custom Salt Formulas</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-ssh.html">Salt SSH</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-rate-limiting.html">Rate Limiting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="salt-scaling-minions.html">Scaling Minions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../large-deployments/overview.html">Large Deployments Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../large-deployments/hardware-reqs.html">Hardware Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../large-deployments/single-server.html">Single Server</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/operation-reqs.html">Operation Requirements</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../large-deployments/multi-server.html">Multiple Servers with Hub</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-reqs.html">Hub Operation Requirements</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-install.html">Hub Installation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-api.html">Hub API</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-namespaces.html">Hub Namespaces</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-auth.html">Hub Authentication</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../large-deployments/hub-reporting.html">Hub Reporting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../large-deployments/retail-large-scale.html">Large Retail Environments</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../large-deployments/tuning.html">Tuning Large Installations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text">xref:large-deployments/monitoring.adoc[Monitoring Large Scale Deployments</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../qs-sap/overview.html">Quick Start: SAP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../qs-sap/prepare-server.html">Prepare Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../qs-sap/prepare-clients.html">Prepare Clients</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../qs-sap/configure.html">Configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE Manager 4.3 Documentation</span>
    <span class="version">default</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../index.html">SUSE Manager 4.3 Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">SUSE Manager 4.3 Documentation</a></li>
    <li><a href="../specialized-guides-overview.html">Specialized Guides</a></li>
    <li><a href="salt-overview.html">Salt Guide</a></li>
    <li><a href="salt-yomi.html">Install Using Yomi</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Install Using Yomi</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_install_the_yomi_formula">1. Install the Yomi Formula</a></li>
<li><a href="#_install_the_pxe_image">2. Install the PXE Image</a></li>
<li><a href="#_register_yomi_in_cobbler">3. Register Yomi in Cobbler</a></li>
<li><a href="#_example_salt_pillar_preparation">4. Example Salt Pillar Preparation</a></li>
<li><a href="#_monitor_the_installation">5. Monitor the Installation</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Yomi (yet one more installer) is an installer for SUSE and openSUSE operating systems.
Yomi is designed as a Salt state, and can be used for installing SUSE operating systems on new systems.</p>
</div>
<div class="paragraph">
<p>In SUSE Manager, Yomi can be used as part of provisioning new clients, as an alternative to AutoYaST.</p>
</div>
<div class="paragraph">
<p>Yomi consists of two components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Yomi formula, which contains the Salt states and modules required to perform the installation.</p>
</li>
<li>
<p>The operating system image, which includes the pre-configured <code>salt-minion</code> service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both components can be used independently of SUSE Manager, or integrated with it.
This section describes how to use it with SUSE Manager.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For more information about using Yomi independently, see <a href="https://github.com/openSUSE/yomi" class="bare">https://github.com/openSUSE/yomi</a>.</p>
</li>
<li>
<p>For build assets, see <a href="https://build.opensuse.org/project/show/systemsmanagement:yomi" class="bare">https://build.opensuse.org/project/show/systemsmanagement:yomi</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use Yomi for installing a client operating system, follow this process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install the <code>yomi-formula</code> package.</p>
</li>
<li>
<p>Prepare the Salt pillar for the new installation.</p>
</li>
<li>
<p>Boot the new client using the PXE boot image for Yomi.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To use Yomi with SUSE Manager, ensure you have enough available memory.
To boot from USB or DVD image, you need at least 512&#160;MB.
To boot from a PXE server, you need at least 2&#160;GB.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install_the_yomi_formula"><a class="anchor" href="#_install_the_yomi_formula"></a><a class="link" href="#_install_the_yomi_formula">1. Install the Yomi Formula</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you begin, you need to install the Yomi formula, which is available as a package in SUSE Manager.</p>
</div>
<div class="paragraph">
<p>The <code>yomi-formula</code> package contains the Salt states and modules that describe the Yomi state, and the formulas with forms to create the pillar.
It also contains documentation about the different sections of the pillar, and some examples about how to parameterize installations based on openSUSE, MicroOS, or SLE.</p>
</div>
<div class="paragraph">
<p>The formula package performs these actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adds a new configuration file called <code>yomi-formula.conf</code> in the <code class="path">/etc/salt/master.d/</code> directory.
This configuration file defines the Python module and Salt states required by Yomi.</p>
</li>
<li>
<p>Installs the Yomi Salt states in the <code class="path">/usr/share/salt-formulas/states/</code> directory.</p>
</li>
<li>
<p>Provides some example configuration files in the <code class="path">/usr/share/yomi/</code> directory.</p>
</li>
<li>
<p>Installs the required forms and sub-forms in the <code class="path">/usr/share/salt-formulas/metadata/</code> directory.</p>
</li>
<li>
<p>Provides some pillar examples in the <code class="path">/usr/share/yomi/pillar/</code> directory.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure: Installing the Yomi Formula</div>
<ol class="arabic">
<li>
<p>On the SUSE Manager Server, at the command prompt, as root, install the <code>yomi-formula</code> package:</p>
<div class="listingblock">
<div class="content">
<pre>zypper in yomi-formula</pre>
</div>
</div>
</li>
<li>
<p>Restart services:</p>
<div class="listingblock">
<div class="content">
<pre>systemctl restart salt-master.service</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information about the Yomi formula, see <a href="salt-formula-yomi.html" class="xref page">Yomi Formula</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install_the_pxe_image"><a class="anchor" href="#_install_the_pxe_image"></a><a class="link" href="#_install_the_pxe_image">2. Install the PXE Image</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>To provision a new client, you need an operating system image to boot from.
You can use any image that contains a <code>salt-minion</code> service enabled, together with a minimal set of tools that are required during the installation, for example <code>parted</code> or <code>btrfstools</code>.</p>
</div>
<div class="paragraph">
<p>Yomi provides an already prepared image, based on openSUSE Tumbleweed, openSUSE Leap (for Uyuni), or SLE (for SUSE Manager).
For SUSE Manager, the image is packaged as an RPM.
This is done in a similar way to how <code>pxe-default-image</code> is distributed.</p>
</div>
<div class="paragraph">
<p>The package installs a standard PXE OEM image generated by Kiwi, the initial kernel and initrd in the <code class="path">/srv/pxe-yomi-image/</code> directory, and the second stage kernel, initrd and image in the <code class="path">/srv/pxe-yomi-image/image</code> directory.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Installing the PXE Image</div>
<ol class="arabic">
<li>
<p>On the SUSE Manager Server, at the command prompt, as root, install the <code>pxe-yomi-image</code> service:</p>
<div class="listingblock">
<div class="content">
<pre>zypper in pxe-yomi-image-sle15</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>When you have the package installed, you can register Yomi in Cobbler.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_register_yomi_in_cobbler"><a class="anchor" href="#_register_yomi_in_cobbler"></a><a class="link" href="#_register_yomi_in_cobbler">3. Register Yomi in Cobbler</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>SUSE Manager uses Cobbler to manage the PXE boot service, so you will need to register the image in Cobbler.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Registering the Yomi Image in Cobbler</div>
<ol class="arabic">
<li>
<p>On the SUSE Manager Server, at the command prompt, as root, create a directory for the Yomi image:</p>
<div class="listingblock">
<div class="content">
<pre>mkdir /srv/tftpboot/pxe-yomi-image</pre>
</div>
</div>
</li>
<li>
<p>Define a distribution in Cobbler, including the path to install the second stage kernel and initrd, the location of the full image, and any further kernel options.
Adjust this command to include the correct version of the product, and the TFTP server address:</p>
<div class="listingblock">
<div class="content">
<pre>cobbler distro add \
  --name=pxe-yomi-image \
  --kernel=/srv/pxe-yomi-image/linux \
  --initrd=/srv/pxe-yomi-image/initrd \
  --boot-files='/srv/tftpboot/pxe-yomi-image/image.initrd=/srv/pxe-yomi-image/image/pxe-yomi-image-sle15.x86_64-1.0.0.initrd /srv/tftpboot/pxe-yomi-image/image.kernel=/srv/pxe-yomi-image/image/pxe-yomi-image-sle15.x86_64-1.0.0.kernel /srv/tftpboot/pxe-yomi-image/image.md5=/srv/pxe-yomi-image/image/pxe-yomi-image-sle15.x86_64-1.0.0.md5 /srv/tftpboot/pxe-yomi-image/image.config.bootoptions=/srv/pxe-yomi-image/image/pxe-yomi-image-sle15-x86_64-1.0.0.config.bootoptions /srv/tftpboot/pxe-yomi-image/image.xz=/srv/pxe-yomi-image/image/pxe-yomi-image-sle15.x86_64-1.0.0.xz' \
  --kernel-options='rd.kiwi.install.pxe rd.kiwi.install.image=tftp://&lt;server-address&gt;/pxe-yomi-image/image.xz rd.kiwi.ramdisk ramdisk_size=2097152 net.ifnames=1'</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>By default, the <code>salt-minion</code> service in <code>pxe-yomi-image</code> is configured to find the Salt master under the <code>salt</code> address.
If the DNS server is not able to resolve this address, you need to adjust the <code>kernel-options</code> parameter from the Cobbler command that register the distribution, and add a new kernel command line of <code>ym.master=master_address</code>.
This will override the default configuration for the <code>salt-minion</code>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Registering the Yomi Profile in Cobbler</div>
<ol class="arabic">
<li>
<p>On the SUSE Manager Server, at the command prompt, as root, define a profile in Cobbler based on the image.</p>
<div class="listingblock">
<div class="content">
<pre>cobbler profile add \
  --name pxe-yomi-profile \
  --distro=pxe-yomi-image</pre>
</div>
</div>
</li>
<li>
<p>OPTIONAL: Create a system in Cobbler.
If you know the MAC address for the new client to be provisioned, you can have it boot directly from the Yomi image.</p>
<div class="listingblock">
<div class="content">
<pre>cobbler system add \
   --name=yomi \
   --mac=00:11:22:33:44:55 \
   --profile=pxe-yomi-profile</pre>
</div>
</div>
</li>
<li>
<p>When the new node has been provisioned, remove the temporary Cobbler system:</p>
<div class="listingblock">
<div class="content">
<pre>cobbler system remove --name=yomi</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_salt_pillar_preparation"><a class="anchor" href="#_example_salt_pillar_preparation"></a><a class="link" href="#_example_salt_pillar_preparation">4. Example Salt Pillar Preparation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The parameters of the new installation are defined with a Salt pillar.
The pillar includes parameters that the Yomi state requires during the installation, including  the partitions, file systems, repositories, packages installed, and services enabled.</p>
</div>
<div class="paragraph">
<p>The pillar is defined using the formulas with forms.
In this example, we prepare the pillar for a minimal openSUSE Tumbleweed installation.
You can find examples for MicroOS or SLES in the example directory <code class="path">/usr/share/yomi/pillar/</code>.</p>
</div>
<div class="paragraph">
<p>To begin, boot the client that you want to provision using the Yomi PXE boot image, using the Cobbler procedures described earlier in this section.</p>
</div>
<div class="paragraph">
<p>When the <code>salt-minion</code> service is running on the new client, accept the key by navigating to <span class="menuseq"><b class="menu">Salt</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Keys</b></span>.
When the key is accepted, you can view and manage the client by navigating to <span class="menuseq"><b class="menu">Systems</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Overview</b></span>.
Navigate to the <code class="guimenu">Formulas</code> tab, and add all the Yomi Installer formulas to the client.
When you have added all the formulas, complete the forms and sub-forms.
This section outlines each form and provides example settings for a minimal installation.
For a detailed explanation of every option, see <a href="salt-formula-yomi.html" class="xref page">Yomi Formula</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Yomi</dt>
<dd>
<p>The Yomi form contains some general configuration options.
For example, the keyboard language and layout, the locale information, and the option to perform a full reset of the system after provisioning.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For this example, set the <code class="parameter">Reboot</code> parameter to <code>yes</code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Yomi Storage</dt>
<dd>
<p>This sub-form provides information about the devices, partitioning, file system (including the BtrFS subvolumes, for example), and LVM and RAID configuration.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For this example, we assume that the new client has a single device named <code>/dev/sda</code>, and that it belongs to a non-UEFI system.
In this case, we have only three partitions: one for the boot loader, one for swap and one for the system.
We also expect to have an ext4 file system for the root directory.</p>
</div>
<div class="paragraph">
<p>Device 1:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Device: /dev/sda</p>
</li>
<li>
<p>Label: GPT</p>
</li>
<li>
<p>Initial Gap: 1&#160;MB</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Create three partitions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Partition 1:</p>
<div class="ulist">
<ul>
<li>
<p>Partition Number: 1</p>
</li>
<li>
<p>Partition Size: 1&#160;MB</p>
</li>
<li>
<p>Partition Type: boot</p>
</li>
</ul>
</div>
</li>
<li>
<p>Partition 2:</p>
<div class="ulist">
<ul>
<li>
<p>Partition Number: 2</p>
</li>
<li>
<p>Partition Size: 1024&#160;MB</p>
</li>
<li>
<p>Partition Type: swap</p>
</li>
</ul>
</div>
</li>
<li>
<p>Partition 3:</p>
<div class="ulist">
<ul>
<li>
<p>Partition Number: 3</p>
</li>
<li>
<p>Partition Size: rest</p>
</li>
<li>
<p>Partition Type: linux</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Create two file systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Filesystem 1:</p>
<div class="ulist">
<ul>
<li>
<p>Partition: /dev/sda2</p>
</li>
<li>
<p>Filesystem: swap</p>
</li>
</ul>
</div>
</li>
<li>
<p>Filesystem 2:</p>
<div class="ulist">
<ul>
<li>
<p>Partition: /dev/sda3</p>
</li>
<li>
<p>Filesystem: ext4</p>
</li>
<li>
<p>Mountpoint: /</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Yomi Bootloader</dt>
<dd>
<p>This sub-form provides details required for GRUB.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Set these parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Device: /dev/sda</p>
</li>
<li>
<p>Theme: selected</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code class="parameter">Kernel</code> parameter can be used for the GRUB <code>append</code> section.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Yomi Software</dt>
<dd>
<p>This form provides the different repositories and packages to install.
You can also register the product in this form, using SUSEConnect, and install the different modules after registering.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For this example we are going to install a very minimal openSUSE Tumbleweed distribution, using publicly available repositories.
For production deployments, you will need to provide a local repository.</p>
</div>
<div class="paragraph">
<p>Add a new repository:
* Repository Name: repo-oss
* Repository URL: <a href="http://download.opensuse.org/tumbleweed/repo/oss/" class="bare">http://download.opensuse.org/tumbleweed/repo/oss/</a></p>
</div>
<div class="paragraph">
<p>Add these packages:
* pattern:enhanced_base
* glibc-locale
* kernel-default</p>
</div>
<div class="paragraph">
<p>You can also add patterns and products, together with packages, by using the correct prefix.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Yomi Services</dt>
<dd>
<p>By default Yomi is installed with the <code>salt-minion</code> service, but you must enable it.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Add a new enabled service:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Service 1:</p>
<div class="ulist">
<ul>
<li>
<p>Service: salt-minion</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Yomi Users</dt>
<dd>
<p>This form sets out the system users.
In this example, we have a single root user.
To provide a password, you must use the hashed version of the password, not the plain text.
This behavior is set to be changed in future versions of Yomi.</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>User 1:</p>
<div class="ulist">
<ul>
<li>
<p>Username: root</p>
</li>
<li>
<p>Password Hash: $1$wYJUgpM5$RXMMeASDc035eXNbYWFl0</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitor_the_installation"><a class="anchor" href="#_monitor_the_installation"></a><a class="link" href="#_monitor_the_installation">5. Monitor the Installation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can monitor the installation as it progresses, using the <code>monitor</code> tool from Yomi.
You can continue monitoring as the highstate is applied to the new client.
To use the tool, you will need to have enabled <code>Events</code> in the Yomi formula, and have the <code>salt-api</code> service activated.</p>
</div>
<div class="paragraph">
<p>For more information about the <code>salt-api</code> service, and how to use the <code>monitor</code> tool, see <a href="https://github.com/openSUSE/yomi" class="bare">https://github.com/openSUSE/yomi</a>.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="salt-gitfs.html">GitFS Fileserver Backend</a></span>
  <span class="next"><a href="salt-config-modules.html">Configuration Modules</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
<script src="../../../_/js/vendor/langSelection.js"></script>

  </body>
</html>
