<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
<title>Migrate SUSE Linux Enterprise Point of Service 11 to SUSE Manager for Retail
     | SUSE Manager 4.3 Documentation</title>    <link rel="canonical" href="https://documentation.suse.com/suma/4.3/en/suse-manager/retail/retail-migration-slepostosuma.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="stylesheet" href="../../_/css/search.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../_/css/font-styles.css">
<link rel="stylesheet" href="../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../_/css/site-extra.css">
<!-- <link rel="preconnect" href="https://fonts.gstatic.com"> -->
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js"
        type="text/javascript"></script>
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
   <div class="navbar-brand">
            <div class="navbar-item">
                <a class=" navbar-logo" href="https://documentation.suse.com/suma/"><img
                        class="logo" src="../../_/img/logo.svg"/></a>
            </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
     <div id="topbar-nav" class="navbar-menu">
          <div class="navbar-end">
              <div class="navbar-item has-dropdown is-hoverable">
                  <div class="navbar-link"><img src="../../_/img/resources.png" class="langIcon Resurces" alt="Resources" title="Resources"></div>
                  <div class="navbar-dropdown">
                      <!--  <div class="navbar-item"><strong>Resources</strong></div> -->
                      <a class="navbar-item" href="https://github.com/uyuni-project/uyuni-docs"><i
                              class="fab fa-github"></i>&nbsp;uyuni-docs</a>
                      <a class="navbar-item" href="https://github.com/uyuni-project/uyuni-docs/issues"><i
                              class="fab fa-github"></i>&nbsp;Report Issue</a>
                      <a class="navbar-item"
                         href="https://github.com/uyuni-project/uyuni-docs/wiki"><i
                              class="fas fa-user-edit"></i>&nbsp;Contribute</a>
                  </div>
              </div>
                           <div class="navbar-item has-dropdown is-hoverable">
                 <div class="navbar-link"><img src="../../_/img/language.png" class="langIcon Language" alt="Language" title="Language"></div>
                 <div class="navbar-dropdown">
                     <!--  </div><div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->
                     <a role="button" class="navbar-item" id="en" onclick="selectLanguage(this.id)"><img src="../../_/img/engFlag.svg" class="langIcon english">&nbsp;English</a>
                     <!-- LANGUAGESELECTOR -->
                     <a role="button" class="navbar-item" id="ko" onclick="selectLanguage(this.id)"><img src="../../_/img/koFlag.svg" class="langIcon korea">&nbsp;한국어</a>
                     <a role="button" class="navbar-item" id="ja" onclick="selectLanguage(this.id)"><img src="../../_/img/jaFlag.svg" class="langIcon japan">&nbsp;日本語</a>
                     <a role="button" class="navbar-item" id="zh_CN" onclick="selectLanguage(this.id)"><img src="../../_/img/china.svg" class="langIcon china">&nbsp;中文</a>
                 </div>
             </div>
                
          </div>
      </div>
      <a id="twitter-link" class="navbar-item" href="https://twitter.com/susemanager">
          <span class="icon">
            <svg aria-hidden="true" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 512 512">
              <path fill="#57aaee"
                    d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path>
            </svg>
          </span>
      </a>
   <!--   <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div> -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="suse-manager" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">SUSE Manager 4.3 Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../common_gfdl1.2_i.html">License</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides/specialized-guides-overview.html">Specialized Guides</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/overview.html">Public Cloud Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Generic Public Cloud</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/setup.html">Initial Setup</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/clients.html">Client Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PAYG Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-overview.html">Pay-as-you-go Overview</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-benefits.html">Benefits of PAYG</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">PAYG on AWS</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-faq.html">PAYG FAQ on AWS</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-country-listing.html">Supported Country List</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-aws-requirements.html">SUSE Manager AWS requirements</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-find-the-aws-image.html">Find the Image</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-configure-the-image.html">Configure the Image on EC2</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-start-the-image.html">Start the Instance</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-initial-setup.html">Initial Setup</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-start-the-server.html">Start the Server</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../specialized-guides/public-cloud-guide/payg/payg-webui-configuration.html">WebUI Configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides/salt/salt-overview.html">Salt Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-terminology.html">Terminology</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-command.html">Salt Command</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-useful-commands.html">Common Salt Commands</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-states-and-pillars.html">Salt States and Pillars</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-gpg-encrypted-pillars.html">GPG Encrypted Pillars</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-custom-states.html">Custom Salt States</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-file-locations.html">File Locations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-gitfs.html">GitFS Fileserver Backend</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-yomi.html">Install Using Yomi</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-config-modules.html">Configuration Modules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides/salt/salt-formulas-intro.html">Salt Formulas</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formulas-by-product.html">Formulas provided by SUSE Manager</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-bind.html">Bind Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-branchnetwork.html">Branch Network Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-dhcpd.html">DHCPd Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-imagesync.html">Image Sync Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-monitoring.html">Monitoring Formulas</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-pxe.html">PXE Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-saltboot.html">Saltboot Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-tftpd.html">TFTPd Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-vsftpd.html">VsFTPd Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formula-yomi.html">Yomi Formula</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/salt/salt-formulas-custom.html">Custom Salt Formulas</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-ssh.html">Salt SSH</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-rate-limiting.html">Rate Limiting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/salt/salt-scaling-minions.html">Scaling Minions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides/large-deployments/overview.html">Large Deployments Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/large-deployments/hardware-reqs.html">Hardware Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides/large-deployments/single-server.html">Single Server</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/large-deployments/operation-reqs.html">Operation Requirements</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides/large-deployments/multi-server.html">Multiple Servers with Hub</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/large-deployments/hub-reqs.html">Hub Operation Requirements</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/large-deployments/hub-install.html">Hub Installation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/large-deployments/hub-api.html">Hub API</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/large-deployments/hub-namespaces.html">Hub Namespaces</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/large-deployments/hub-auth.html">Hub Authentication</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../specialized-guides/large-deployments/hub-reporting.html">Hub Reporting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/large-deployments/retail-large-scale.html">Large Retail Environments</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/large-deployments/tuning.html">Tuning Large Installations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <span class="nav-text">xref:large-deployments/monitoring.adoc[Monitoring Large Scale Deployments</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../specialized-guides/qs-sap/overview.html">Quick Start: SAP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/qs-sap/prepare-server.html">Prepare Server</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/qs-sap/prepare-clients.html">Prepare Clients</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../specialized-guides/qs-sap/configure.html">Configuration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE Manager 4.3 Documentation</span>
    <span class="version">default</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">SUSE Manager 4.3 Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">SUSE Manager 4.3 Documentation</a></li>
    <li><a href="retail-migration-slepostosuma.html">Migrate SUSE Linux Enterprise Point of Service 11 to SUSE Manager for Retail</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Migrate SUSE Linux Enterprise Point of Service 11 to SUSE Manager for Retail</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#retail_migr.sect.slepostosuma.s1.complete">1. Migration with Complete Data Dump</a></li>
<li><a href="#retail_migr.sect.slepostosuma.s1.bbb">2. Migration with Branch by Branch Data Dump</a></li>
<li><a href="#retail_migr.sect.slepostosuma.s1.x2y">3. Converting XML to YAML</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section describes migrating from an existing SUSE Linux Enterprise Point of Service 11 installation to a new SUSE Manager installation.
You can perform this migration all at once by creating a data dump in a single file, and then moving it to the new server.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can perform the migration in stages by creating a data dump for each branch, and moving them to the new server one by one.
Importing and deploying the converted data can also be done in one or multiple steps, depending on your environment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="retail_migr.sect.slepostosuma.s1.complete"><a class="anchor" href="#retail_migr.sect.slepostosuma.s1.complete"></a><a class="link" href="#retail_migr.sect.slepostosuma.s1.complete">1. Migration with Complete Data Dump</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this procedure, you create a single data dump in an XML file, convert it to YAML, and migrate it to the new infrastructure all at once.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the SUSE Manager for Retail server 4.3.
For more information, see <a href="retail-install-unified.html" class="xref page">Install with the Unified Installer</a>.</p>
</li>
<li>
<p>On the SLEPOS Admin server export all the data stored in LDAP to an XML file.
Run this command as an administrator:</p>
<div class="listingblock">
<div class="content">
<pre>posAdmin --export --type xml --file dumpfile.xml</pre>
</div>
</div>
<div class="paragraph">
<p>The resulting <code class="literal">dumpfile.xml</code> file will contain global information, with parts about images, hardware and its partitioning, and the description of the branch servers with networking data, services, and attached terminals.</p>
</div>
</li>
<li>
<p>Move the XML file to the newly created SUSE Manager server, and convert it to YAML:</p>
<div class="listingblock">
<div class="content">
<pre>retail_migration dumpfile.xml retail.yml</pre>
</div>
</div>
</li>
<li>
<p>Review the generated YAML file (<code class="literal">retail.yml</code>) and adjust it as necessary.
Consider <code>HWTYPE</code> group naming and image name and version changes in the partitioning data.
Group names must not exceed the 56 character limit.
You can shorten the names as needed, and the image names must match the images in SUSE Manager.
The <code class="option">--save-mapping</code> option can help you with this task.</p>
<div class="paragraph">
<p>Also check whether there are duplicate MAC addresses of the terminals in the generated YAML file.
Choose which entry you want to keep.
If there are duplicate MAC addresses, importing the YAML file will fail.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>SUSE Linux Enterprise Point of Service images will not be migrated. You must rebuild the images using the OS image building functionality.
For more information about building images, see <a href="../administration/image-management.html" class="xref page">Image Building and Management</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Import the complete data (YAML) with:</p>
<div class="listingblock">
<div class="content">
<pre>retail_yaml --from-yaml retail.yml</pre>
</div>
</div>
<div class="paragraph">
<p>You can see statistical data while the import is in progress.
Check the results in the Web UI by navigating to <span class="menuseq"><b class="menu">Systems</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="submenu">System List</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">All</b></span> and find empty profiles.
To see the groups for the hardware configuration, branches, servers, and terminals, navigate to <span class="menuseq"><b class="menu">Systems</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Groups</b></span>.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To finalize the branch server migration, you must install the branch server machines as Salt clients and bootstrap them as proxies.
For more information about proxy installation, see <a href="retail-install.html" class="xref page">Retail Installation</a>.
For more information about using an activation key to assign the required channels, see <a href="retail-install-setup.html" class="xref page">Set Up the SUSE Manager for Retail Environment</a>.
After onboarded to SUSE Manager, the branch servers machines are connected with the empty profiles (by FQDN), and so they will get the Retail configuration.</p>
</div>
<div class="paragraph">
<p>After all the branches are migrated, shutdown and remove the old SLEPOS Admin Server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="retail_migr.sect.slepostosuma.s1.bbb"><a class="anchor" href="#retail_migr.sect.slepostosuma.s1.bbb"></a><a class="link" href="#retail_migr.sect.slepostosuma.s1.bbb">2. Migration with Branch by Branch Data Dump</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this procedure, you migrate the SLEPOS infrastructure and the branches one by one, first exporting and then importing.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the SUSE Manager for Retail server 4.3
For more information, see <a href="retail-install-unified.html" class="xref page">Install with the Unified Installer</a>.</p>
</li>
<li>
<p>On every branch server:</p>
<div class="listingblock">
<div class="content">
<pre>posAdmin --export --type xml --file dumpfile.xml</pre>
</div>
</div>
<div class="paragraph">
<p>These dumps will contain only the LDAP data of the branch, and any global data.</p>
</div>
</li>
<li>
<p>Similarily, you can export the LDAP data of every branch if you run the command on the Admin server with the branch credentials explicitly specified:</p>
<div class="listingblock">
<div class="content">
<pre>posAdmin --export --type xml --file dumpfile.xml --user $branch_dn \
    --password $password</pre>
</div>
</div>
<div class="paragraph">
<p>For background information about SLEPOS branch server configuration, see <a href="https://documentation.suse.com/sle-pos/11-SP3/html/SLEPOS-guide/cha.slepos_branchserv.html" class="bare">https://documentation.suse.com/sle-pos/11-SP3/html/SLEPOS-guide/cha.slepos_branchserv.html</a>.</p>
</div>
</li>
<li>
<p>Review the generated YAML file (<code class="literal">retail.yml</code>) and adjust it as necessary.
Consider <code>HWTYPE</code> group naming and image name and version changes in the partitioning data.
You can shorten the names as needed, and the image names must match the images in SUSE Manager.
The <code class="option">--save-mapping</code> option can help you with this task.</p>
</li>
<li>
<p>Check whether there are duplicate MAC addresses of the terminals in the generated YAML file.
Choose which entry you want to keep.
As long as there are duplicate MAC addresses, SUSE Manager will refuse importing the YAML file.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>SUSE Linux Enterprise Point of Service images will not be migrated. You must rebuild the images using the OS image building functionality.
For more information about building images, see <a href="../administration/image-management.html" class="xref page">Image Building and Management</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The data can be imported branch by branch.
For each branch perform the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the import command for one branch after the other:</p>
<div class="listingblock">
<div class="content">
<pre>retail_yaml --from-yaml retail.yml --branch &lt;branch_name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Repeat the command for every branch.</p>
</div>
</li>
<li>
<p>To finalize each branch server migration, you must install the branch server machine as a Salt-based client and bootstrap it as a proxy.
For more information about proxy installation, see <a href="retail-install.html#retail.sect.install.branch" class="xref page">Installing and Registering</a>.
For more information about using an activation key to assign the required channels, see <a href="retail-install.html#retail.sect.install.install.config" class="xref page">Configuring Server</a>.
After onboarded to SUSE Manager for Retail, the branch server machine is connected with the empty profile (by FQDN), and so it will get the Retail configuration.</p>
</li>
<li>
<p>Apply Highstate on the branch server; this will happen automatically if <code class="guimenu">Configuration File Deployment</code> is enabled.</p>
</li>
<li>
<p>Boot the terminals of the branch.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After all the branches are migrated, shut down and remove the old SLEPOS Admin Server.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="retail_migr.sect.slepostosuma.s1.x2y"><a class="anchor" href="#retail_migr.sect.slepostosuma.s1.x2y"></a><a class="link" href="#retail_migr.sect.slepostosuma.s1.x2y">3. Converting XML to YAML</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you perform a migration using one of the methods in this chapter, one of the steps takes the XML data dump file from SUSE Linux Enterprise Point of Service, and converts it to a YAML file for SUSE Manager for Retail.
The tool that performs this conversion has additional features, which are outlined in this section.</p>
</div>
<div class="paragraph">
<p>To validate the XML file before conversion, and print any errors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>retail_migration dumpfile.xml</pre>
</div>
</div>
<div class="paragraph">
<p>To write a mapping file called <code class="path">map.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>retail_migration dumpfile.xml  --save-mapping map.yml</pre>
</div>
</div>
<div class="paragraph">
<p>The mapping file contains two dictionaries:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code class="systemitem">images</code>, which maps old SUSE Linux Enterprise Point of Service images to new images built in SUSE Manager.</p>
</li>
<li>
<p><code class="systemitem">groups</code>, which maps legacy SUSE Linux Enterprise Point of Service <code class="systemitem">scCashRegister</code> objects to SUSE Manager <code class="systemitem">HWTYPE</code> groups.
Group names must not exceed the 56 character limit.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The mapping file should be edited as required for your environment.</p>
</div>
<div class="paragraph">
<p>To perform a conversion using a mapping file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>retail_migration dumpfile.xml  retail.yml --mapping map.yml</pre>
</div>
</div>
<div class="paragraph">
<p>If you are performing a branch-by-branch migration, the resulting <code class="path">retail.yml</code> file will contain a new version of SUSE Linux Enterprise Point of Service LDAP data.
If you want to preserve any global changes in your SUSE Manager for Retail settings, remove the <code class="systemitem">global</code> hardware types from the resulting <code class="path">retail.yml</code> file before importing it.
Alternatively, you can import <code class="path">retail.yml</code> using this command to import only the new systems and groups defined in the file, and leave any existing configuration settings untouched:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>retail_yaml --only-new</pre>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
<script src="../../_/js/vendor/langSelection.js"></script>

  </body>
</html>
