[[subscription-matching]]
= Subscription Matching


{productname} runs a nightly report checking the subscription status of all clients against your {scc} (SCC) account.
Navigate to menu:Audit[Subscription Matching] to see the report.

The [guimenu]``Subscriptions Report`` tab gives information about current and expiring subscriptions.

The [guimenu]``Unmatched Products Report`` tab gives a list of clients that do not have a current subscription.
This includes clients that could not be matched, or that are not currently registered with {productname}.
The report includes product names and the number of systems that remain unmatched.

The [guimenu]``Pins`` tab allows you to associate individual clients to the relevant subscription.
This is especially useful if the subscription manager is not automatically associating clients to subscriptions successfully.

The [guimenu]``Messages`` tab shows any errors that occurred during the matching process.

You can also download the reports in .csv format, or access them from that command prompt in the [path]``/var/lib/spacewalk/subscription-matcher/`` directory.

By default, the subscription matcher runs daily, at midnight.
To change this, navigate to menu:Admin[Task Schedules] and click ``gatherer-matcher-default``.
Change the schedule as required, and click btn:``Update Schedule``.


[IMPORTANT]
====
The subscription matcher will not always match clients and subscriptions accurately.
It is not intended to be a replacement for auditing.
====



== Pin Clients to Subscriptions

The subscription pinning feature allows a user to instruct the subscription matcher to favor matching a specific subscription with a given system or group of systems.
This is achieved by creating pins.
Each pin contains information about the preferred subscription-system match.

image::audit_subscription_matching_pins.png[scaledwidth=80%]

[NOTE]
.Respecting Pins
====
In some cases the algorithm may determine that a specific pin cannot be respected, depending on the subscription's availability and applicability rules, in this case it will be shown as not satisfied.
====

The pins table displays a list of all pins.
Items in the list contain the status of pins, which can be ``satisfied``, `not    satisfied` and ``pending next run``.

* A pin is `satisfied` if its system and subscription was matched in the last matcher run.
* A pin is `not satisfied` if its system and subscription was _not_ matched in the last matcher run.
This can happen, for example, if the pin violates terms and conditions for subscriptions.
* A pin is in the `pending next run` state when it needs a new matcher run to be taken into account.
After the new run, the pin will become either `satisfied` or ``not satisfied``.

image::sm-pins.png[scaledwidth=80%]

Click the btn:[Add a Pin] button to open the [guimenu]``Available Systems`` window.
You may filter systems by name and select a system for the matcher to pin manually.

image::add-pin.png[scaledwidth=80%]

Within the menu:Subscriptions Available for Selected System[] window click the menu:Save Pin[] button to raise priority for subscription use on the selected system.



[[ref.webui.audit.submatch.submatch.messages]]
== Messages



image::audit_subscription_matching_messages.png[scaledwidth=80%]
