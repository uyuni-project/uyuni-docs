[[yomi-formula]]
= Yomi Formula

Yhe Yomi (yet one more installer) installer for {suse} and openSUSE operating systems is configured using formulas with forms.

The ``yomi-formula`` package provides these formulas:

* Yomi
* Yomi Storage
* Yomi Bootloader
* Yomi Software
* Yomi Services
* Yomi Users


.Procedure: Install the Yomi Formulas with Forms
. On the {productname} Server, at the command prompt, as root, install the ``yomi-formula`` package:
+
----
zypper in yomi-formula
----
. In the {susemgr} {webui}, open the details page for the Salt master, and navigate to the Formulas tab.
. Check the [guimenu]``Installer`` box, and click btn:[Save].
. Apply the highstate.



.Procedure: Configuring the Yomi Formula
. Navigate to the menu:Formulas[Yomi] tab, and set these parameters int he [guimenu]``GeneralÂ Configuration`` section:
* Check the [guimenu]``Events`` box to allow monitoring.
* In the [guimenu]``Reboot`` field, select [systemitem]``yes`` to instruct the client to reboot after installation.
* Check the [guimenu]``Snapper`` box if you are using the btrfs file system on the client.
* In the [guimenu]``Locale`` field, select the region and encoding for systemd to use on the client (for example: [systemitem]``en_US.utf8`` for American English and UTF-8).
* In the [guimenu]``Keymap`` field, select the appropriate keyboard layout (for example: [systemitem]``us`` for an American keyboard layout).
* In the [guimenu]``Timezone`` field, select the timezone for the client to use (for example: [guimenu]``America/New_York`` for EST).
* In the [guimenu]``Hostname`` field, enter the hostname for the client to use.
Leave this blank if you are using DHCP to provide the hostname.
* In the [guimenu]``Machine Id`` field, enter a machine identification number for the client.
Leave this blank to have systemd generate one automatically.
* In the [guimenu]``Target`` field, enter a systemd target unit.
. Click btn:[Save Formula] to save your configuration.
. Apply the highstate.


////
 Example content from Yomi chapter below this line. --LKB 2020-03-26


Yomi Storage::

This sub-form provides information about the devices, partitioning, file system (including the BtrFS subvolumes, for example), and LVM and RAID configuration.

For this example, we assume that the new client has a single device named ``/dev/sda``, and that it belongs to a non-UEFI system.
In this case, we have only three partitions: one for the boot loader, one for swap and one for the system.
We also expect to have an ext4 file system for the root directory.

Device 1:

* Device: /dev/sda
* Label: GPT
* Initial Gap: 1MB

Create three partitions:

* Partition 1:
** Partition Number: 1
** Partition Size: 1MB
** Partition Type: boot
* Partition 2:
** Partition Number: 2
** Partition Size: 1024MB
** Partition Type: swap
* Partition 3:
** Partition Number: 3
** Partition Size: rest
** Partition Type: linux

Create two file systems:

* Filesystem 1:
** Partition: /dev/sda2
** Filesystem: swap
* Filesystem 2:
** Partition: /dev/sda3
** Filesystem: ext4
** Mountpoint: /


Yomi Bootloader::

This sub-form provides details required for GRUB.

Set these parameters:

* Device: /dev/sda
* Theme: selected

The [parameter]``Kernel`` parameter can be used for the GRUB ``append`` section.


Yomi Software::

This form provides the different repositories and packages to install.
You can also register the product in this form, using SUSEConnect, and install the different modules after registering.

For this example we are going to install a very minimal openSUSE Tumbleweed distribution, using publicly available repositories.
For production deployments, you will need to provide a local repository.

Add a new repository:
* Repository Name: repo-oss
* Repository URL: http://download.opensuse.org/tumbleweed/repo/oss/

Add these packages:
* pattern:enhanced_base
* glibc-locale
* kernel-default

You can also add patterns and products, together with packages, by using the correct prefix.


Yomi Services::

By default Yomi is installed with the ``salt-minion`` service, but you must enable it.

Add a new enabled service:

* Service 1:
** Service: salt-minion


Yomi Users::

This form sets out the system users.
In this example, we have a single root user.
To provide a password, you must use the hashed version of the password, not the plain text.
This behavior is set to be changed in future versions of Yomi.

* User 1:
** Username: root
** Password Hash: $1$wYJUgpM5$RXMMeASDc035eX.NbYWFl0

////