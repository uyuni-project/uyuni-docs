[[yomi-formula]]
= Yomi Formula

Yhe Yomi (yet one more installer) installer for {suse} and openSUSE operating systems is configured using formulas with forms.

The ``yomi-formula`` package provides these formulas:

* Yomi
* Yomi Storage
* Yomi Bootloader
* Yomi Software
* Yomi Services
* Yomi Users


.Procedure: Install the Yomi Formulas with Forms
. On the {productname} Server, at the command prompt, as root, install the ``yomi-formula`` package:
+
----
zypper in yomi-formula
----
. In the {susemgr} {webui}, open the details page for the Salt master, and navigate to the Formulas tab.
. Check the [guimenu]``Installer`` box, and click btn:[Save].
. Apply the highstate.



.Procedure: Configuring the Yomi Formula
. Navigate to the menu:Formulas[Yomi] tab, and set these parameters in the [guimenu]``General Configuration`` section:
* Check the [guimenu]``Events`` box to allow monitoring.
* In the [guimenu]``Reboot`` field, select [systemitem]``yes`` to instruct the client to reboot after installation.
* Check the [guimenu]``Snapper`` box if you are using the btrfs file system on the client.
* In the [guimenu]``Locale`` field, select the region and encoding for systemd to use on the client (for example: [systemitem]``en_US.utf8`` for American English and UTF-8).
* In the [guimenu]``Keymap`` field, select the appropriate keyboard layout (for example: [systemitem]``us`` for an American keyboard layout).
* In the [guimenu]``Timezone`` field, select the timezone for the client to use (for example: [guimenu]``America/New_York`` for EST).
* In the [guimenu]``Hostname`` field, enter the hostname for the client to use.
Leave this blank if you are using DHCP to provide the hostname.
* In the [guimenu]``Machine Id`` field, enter a machine identification number for the client.
Leave this blank to have systemd generate one automatically.
* In the [guimenu]``Target`` field, enter a systemd target unit.
. Click btn:[Save Formula] to save your configuration.
. Apply the highstate.



.Procedure: Configuring the Yomi Storage Formula
. Navigate to the menu:Formulas[Yomi Storage] tab, and set these parameters in the menu:Partitions[Config] section:
* In the [guimenu]``Labels`` field, select the default partition table type to use.
* In the [guimenu]``Initial Gap`` field, select the default amount of space to leave before each partition.
For example: [systemitem]``1{nbsp}MB``, or use [systemitem]``0`` to leave no space between partitions.
. For each device that you want to create, in the menu:Partitions[Devices] section, click btn:[+], and set these parameters:
* In the [guimenu]``Device`` field, type the mount point for the device.
For example, [systemitem]``/dev/sda``.
* In the [guimenu]``Label`` field, select the partition table type to use, if it is different from the default label you selected.
* In the [guimenu]``Initial Gap`` field, select the amount of space to leave before each partition, if it is different from the default space you specified.
. For each partition that you want to create, in the menu:Partitions[Devices > Partitions] section, click btn:[+], and set these parameters:
* In the [guimenu]``Partition Number`` field, enter a number for the partition.
The number you enter here is be appended to the device name to identify the partition.
For example, partition number [systemitem]``1`` on device [systemitem]``/dev/sda`` can be identified as [systemitem]``/dev/sda1``.
* In the [guimenu]``Partition Name`` field, enter a name for the partition.
Leave this blank if you have entered a partition number in the previous field.
* In the [guimenu]``Partition Size`` field, enter a size for the partition.
For example: [systemitem]``500{nbsp}MB``.
Use [systemitem]``rest`` to use all the remaining free space.
. For each file system that you want to create, in the [guimenu]``Filesystems`` section, click btn:[+], and set these parameters:
* In the [guimenu]``Partition`` field, select the partition to create the file system on.
For example, [systemitem]``/dev/sda1``.
* In the [guimenu]``Filesystem`` field, select the filesystem type to create.
* In the [guimenu]``Mountpoint`` field, type the mount point for the filesystem.
For example: [systemitem]``/`` for root.
. Click btn:[Save Formula] to save your configuration.
. Apply the highstate.

[[NOTE]]
====
If you want to use LVM or RAID on your devices, click btn:[+] in the appropriate sections, and complete the details for your environment.
====



////
 Example content from Yomi chapter below this line. --LKB 2020-03-26





Yomi Bootloader::

This sub-form provides details required for GRUB.

Set these parameters:

* Device: /dev/sda
* Theme: selected

The [parameter]``Kernel`` parameter can be used for the GRUB ``append`` section.


Yomi Software::

This form provides the different repositories and packages to install.
You can also register the product in this form, using SUSEConnect, and install the different modules after registering.

For this example we are going to install a very minimal openSUSE Tumbleweed distribution, using publicly available repositories.
For production deployments, you will need to provide a local repository.

Add a new repository:
* Repository Name: repo-oss
* Repository URL: http://download.opensuse.org/tumbleweed/repo/oss/

Add these packages:
* pattern:enhanced_base
* glibc-locale
* kernel-default

You can also add patterns and products, together with packages, by using the correct prefix.


Yomi Services::

By default Yomi is installed with the ``salt-minion`` service, but you must enable it.

Add a new enabled service:

* Service 1:
** Service: salt-minion


Yomi Users::

This form sets out the system users.
In this example, we have a single root user.
To provide a password, you must use the hashed version of the password, not the plain text.
This behavior is set to be changed in future versions of Yomi.

* User 1:
** Username: root
** Password Hash: $1$wYJUgpM5$RXMMeASDc035eX.NbYWFl0

////