[[salt-state-modules]]
= Configuration State Modules

Salt State Modules are the components that map to
actual enforcement and management of Salt states.

States are configuration templates which are composed by calling salt state modules.

{productname} provide a set of states to configure organizations, users, user permissions on channels and system groups.
Those are provided in a form of a package which contains the salt state modules and set of examples.

For more information on states and how to use them,
see https://docs.saltstack.com/en/latest/topics/tutorials/starting_states.html.

== Installations instruction
To install these states a user should install the following package on the {productname} server:

`zypper in susemanager-config-modules`

For more information check the state implementation on `/usr/share/susemanager/salt/_states/uyuni_config.py`

Examples also available at: `???`

== Available states

=== org_present
**(name, org_admin_user, org_admin_password, first_name, last_name, email, pam=False, admin_user=None, admin_password=None)**

Create or update {productname} organization. admin_user must have administrator role to perform this action.

....
name: organization name
org_admin_user: organization admin user
org_admin_password: organization admin password
first_name: organization admin first name
last_name: organization admin last name
email: organization admin email
pam: organization admin pam authentication
admin_user: admin user
admin_password: admin password
....

=== org_absent
**(name, admin_user=None, admin_password=None)**

Delete {productname} organization. admin_user must have administrator role to perform this action.

....
name: organization name
admin_user: admin user
admin_password: admin password
....

=== org_trust
**(name, org_name, trusts, admin_user=None, admin_password=None)**

Add trusted organisations to an organization.

....
name: state name
org_name: Organization name
trusts: list of organization names to trust
admin_user: administrator username
admin_password: administrator password
....

=== group_present
**(name, description, expression=None, target=`glob', org_admin_user=None, org_admin_password=None)**

Create or update a system group.

....
name: group name
description: group description
expression: expression used to filter which minions should be part of the group
target: target type, one of the following: glob, grain, grain_pcre, pillar, pillar_pcre,
        pillar_exact, compound, compound_pillar_exact. Default: glob.
org_admin_user: organization administrator username
org_admin_password: organization administrator password
....

=== group_absent
**(name, org_admin_user=None, org_admin_password=None)**

Remove system group if present.

....
name: group Name
org_admin_user: organization administrator username
org_admin_password: organization administrator password
....

=== user_present
**(name, password, email, first_name, last_name, use_pam_auth=False, roles=None, system_groups=None, org_admin_user=None, org_admin_password=None)**

Insure user is present with all his characteristics.

....
name: user ID
password: desired password for the user
email: valid email address
first_name: user's first name
last_name: user's last name
use_pam_auth: user is authenticated using pam
roles: user desired roles
system_groups: system groups user is part of
org_admin_user: organization administrator username
org_admin_password: organization administrator password
....

=== user_absent
**(name, org_admin_user=None, org_admin_password=None)**

Remove user if it exists.

....
name: user id
org_admin_user: organization administrator username
org_admin_password: organization administrator password
....

=== user_channels
**(name, password, manageable_channels=[], subscribable_channels=[], org_admin_user=None, org_admin_password=None)**

Set user permissions to access channels.

....
name: user ID
password: user password
manageable_channels: channels user can manage
subscribable_channels: channels user can subscribe
org_admin_user: organization administrator username
org_admin_password: organization administrator password
....
