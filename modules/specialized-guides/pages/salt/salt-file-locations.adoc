[[salt.file.locations]]
= Salt File Locations and Structure


There are several ways to set up the Salt file structure.
This section describes how Salt is supported and set up as part of {productname} Server.
The main configuration file is [path]``/etc/salt/master.d/susemanager.conf``.

[NOTE]
====
Do not edit the [path]``/etc/salt/master.d/susemanager.conf`` configuration file.
This file belongs to the [package]``spacewalk-setup`` package and is marked as [literal]``%config``.
When {suse} updates the [package]``spacewalk-setup`` package, the [path]``susemanager.conf`` file is overwritten, and any customization is lost.
Instead, add your own configuration file to the [path]``/etc/salt/master.d/`` directory.
This prevents the update process from deleting your settings from the main [path]``susemanager.conf`` configuration file.
====

Some settings from [path]``/etc/salt/master.d/susemanager.conf`` that can help with finding configuration options:

[source]
----
# Configure different file roots. Custom salt states should only be placed in
# /srv/salt.
# Users should not touch other directories listed here.
file_roots:
  base:
    - /usr/share/susemanager/salt
    - /usr/share/salt-formulas/states
    - /usr/share/susemanager/formulas/states
    - /srv/susemanager/salt
    - /srv/salt

# Configure different pillar roots. Custom pillar data should only be placed
# in /srv/pillar.
# Users should not touch other directories listed here.
pillar_roots:
  base:
    - /srv/pillar
----

When you are working with [path]``/etc/salt/master.d/susemanager.conf``, be aware that:

* Files listed are searched in the order they appear
* The first matching file found is called

The {productname} Server reads Salt state data from five root directories:

[path]``/usr/share/susemanager/salt``::
This directory is shipped and updated with {productname} and includes certificate setup and common state logic to be applied to packages and channels.

[WARNING]
====
Do not edit or add custom Salt data to this directory.
====

[path]``/usr/share/salt-formulas/states``::
[path]``/usr/share/susemanager/formulas/states``::
These directories are shipped and updated with {productname} or additional extensions.
They include states for Salt formulas.

[WARNING]
====
Do not edit or add custom Salt data to this directory.
====

[path]``/srv/susemanager/salt``::
This directory is generated by {productname}, based on assigned channels and packages for clients, groups, and organizations.
This directory will be overwritten and regenerated.
It is the Salt equivalent of the {productname} database.

[WARNING]
====
Do not edit or add custom Salt data to this directory.
====

Within this directory, each organization has a sub-directory.

.Example: SLS File Directory Structure
[source]
----
├── manager_org_<org id>
│   ├── files
│   │    ... files needed by states (uploaded by users)...
│   └── state.sls
         ... other SLS files (created by users)...
For example:
├── manager_org_TESTING
│   ├── files
│   │   └── motd     # user created
│   │    ... other files needed by states ...
│   └── motd.sls     # user created
            ... other SLS files ...
----

[path]``/srv/salt``::
This directory is used for custom state data, modules, and related data.
{productname} does not operate or use this directory directly.
The state data in this directory is used by the client highstate, and is merged with the total state result generated by {productname}.
Use this directory for custom Salt data.

The {productname} Server reads Salt pillar data from two root directories:

/usr/share/susemanager/pillar::
This directory is generated by {productname}.
It is shipped and updated together with {productname}.

[WARNING]
====
Do not edit or add custom Salt data to this directory.
====

/srv/pillar::
By default, {productname} does not operate or use this directory directly.
The custom pillar data in this directory is merged with the pillar result created by {productname}.
Use this directory for custom Salt pillar data.

[NOTE]
====
You can use the [systemitem]``gitfs`` fileserver backend to serve Salt data from git repositories.
For more information, see xref:specialized-guides:salt/salt-gitfs.adoc[].
====
